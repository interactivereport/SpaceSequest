# VisiumHD

## SpaceRanger run

## Pipeline setup

## Results


Demo run directory: ~/SpaceSequest_demo/3_VisiumHD

Demo data were downloaded from 10X genomics website, and stored in the above directory.

Sample1: Mouse brain FFPE: https://www.10xgenomics.com/datasets/visium-hd-cytassist-gene-expression-libraries-of-mouse-brain-he

Sample2: Mouse brain fixed frozen: https://www.10xgenomics.com/datasets/visium-hd-cytassist-gene-expression-mouse-brain-fixed-frozen

```
#First step, generate config and sampleMeta file

visiumhd ~/SpaceSequest_demo/3_VisiumHD
```

After this step, fill in the config.yml file and the sampleMeta.csv file as below.

```
project_ID: VisiumHD_demo     #required

sampleMeta: ~/SpaceSequest_demo/3_VisiumHD/sampleMeta.csv      #path to the sampleMeta file

output_dir: ~/SpaceSequest_demo/3_VisiumHD/output     #output directory

bin_resolution: 8um   #defaul 8um, also 16um or 2um are available

cluster_resolution: 0.3      #resolution for the FindClusters step

reference: ~/SpaceSequest_demo/3_VisiumHD/Reference/allen_mop_2020.rds  #path to an Azimuth reference data, optional

reference_name: subclass     #column name of the cell type label you would like to transfer

integrate_data: True        #True or False to merge/integrate all the data in the sampleMeta file

integrate_with_harmony: True  #True or False to use Harmony for integration. Default as True
```

The sampleMeta.csv file contains file name and path to the Space Ranger output. It needs to have the h5 files and binned_outputs inside:

```
Sample,Directory

Mouse_brain_FFPE,~/SpaceSequest_demo/3_VisiumHD/Sample1_FFPE

Mouse_brain_FixedFrozen,~/SpaceSequest_demo/3_VisiumHD/Sample2_Fixed
```
Finally submit the following command using sbatch:

```
#Run the data

visiumhd ~/SpaceSequest_demo/3_VisiumHD/config.yml
```
Finally check the results in the output_dir folder specified in the config.yml file. The output files contain some plots (QC plots, UMAP), and Rdata files storing the results.

::: {#fig:VisumHD .figure}
![Figure 3A](https://interactivereport.github.io/SpaceSequest/images/VisiumHD_demo.Spatial.png){width=48%}
![Figure 3B](https://interactivereport.github.io/SpaceSequest/images/VisiumHD_demo.UMAP.png){width=48%}

:::

Figure 3. Visium HD spatial-transcriptomics output. (Left) Tissue image with capture spots overlaid. (Right) UMAP embedding of spatial barcodes colored by cluster.
